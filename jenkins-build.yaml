---
- name: Install Jenkins on Fedora
  hosts: all
  become: true
  vars:
    jenkins_admin_username: admin
    jenkins_admin_password: admin123

  tasks:
    - name: Install Jenkins dependencies
      dnf:
        name:
          - java-1.8.0-openjdk-devel
          - wget
        state: present

    - name: Install Jenkins
      become_user: "{{ jenkins_admin_username }}"
      command: |
        wget -q -O - https://pkg.jenkins.io/redhat-stable/jenkins.io.key | sudo rpm --import -
        sudo sh -c 'echo -e "[jenkins]\nname=Jenkins-stable\nbaseurl=https://pkg.jenkins.io/redhat-stable\ngpgcheck=1" > /etc/yum.repos.d/jenkins.repo'
        sudo dnf install -y jenkins

    - name: Set Jenkins admin username and password
      become_user: "{{ jenkins_admin_username }}"
      command: |
        sudo sh -c 'echo "{{ jenkins_admin_username }}:{{ jenkins_admin_password }}" > /var/lib/jenkins/secrets/initialAdminPassword'
